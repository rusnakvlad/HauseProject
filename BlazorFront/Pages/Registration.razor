@page "/Registration"
@using BuisnesLogicLayer.DTO
@using BlazorFront.Services
@inject NavigationManager NavigationManager
@inject IUserServices userServices
@inject Blazored.LocalStorage.ILocalStorageService localStorage

<div class="container mt-5 mb-5">
    <div class="row d-flex align-items-center justify-content-center">
        <div class="col-md-6">
            <div class="card px-5 py-5">
                <EditForm Model="@user" OnValidSubmit="HandleSubmitValidForm">
                    <DataAnnotationsValidator />
                    <ValidationSummary />
                    <span class="circle"><i class="fa fa-check"></i></span>
                    <h5 class="mt-3">Реєстрація</h5> <small class="mt-2 text-muted"></small>

                    <div class="form-input">
                        <i class="fa fa-envelope"></i>
                        <input @bind="@user.Email" type="text" class="form-control" placeholder="Почта">
                        <ValidationMessage For="@(() => user.Email)" />
                    </div>

                    <div class="form-input">
                        <i class="fa fa-user"></i>
                        <input @bind="@user.Name" type="text" class="form-control" placeholder="Ім'я">
                        <ValidationMessage For="@(() => user.Name)" />
                    </div>

                    <div class="form-input">
                        <i class="fa fa-user"></i>
                        <input @bind="@user.Surname" type="text" class="form-control" placeholder="Прізвище">
                        <ValidationMessage For="@(() => user.Surname)" />
                    </div>

                    <div class="form-input">
                        <i class="fa fa-phone"></i> +380
                        <input @bind="@user.Phone" type="text" class="form-control" placeholder="">
                        <ValidationMessage For="@(() => user.Phone)" />
                    </div>

                    <div class="form-input">
                        <i class="fa fa-lock"></i> <span style="font-size:8pt;">Довжина пароля не меньше 5 символів і хоча б одна велика літера одна цифра та знак</span>
                        <input asp-for="Password" @bind="@user.Password" type="text" class="form-control" placeholder="Пароль">
                        <ValidationMessage For="(() => user.Password)" />
                    </div>

                    <div class="form-input">
                        <i class="fa fa-lock"></i>
                        <input @bind="@user.PasswordConfirmation" type="text" class="form-control" placeholder="Пароль">
                        <ValidationMessage For="(() => user.PasswordConfirmation)" />
                    </div>

                    <div class="form-check"> <input class="form-check-input" type="checkbox" value="" id="flexCheckChecked" checked> <label class="form-check-label" for="flexCheckChecked"> Я примаю всі умви конфіденційності</label> </div>
                    <button type="submit" @onclick="Register" class="btn btn-primary mt-4 signup">Зареєструватися</button>
                    <div class="text-center mt-4"> <span>Вже зареєстровані</span> <NavLink href="LogIn"> <span class="text-decoration-none">Війти</span></NavLink> </div>
                </EditForm>
            </div>
        </div>
    </div>
</div>

<div></div>
@code {
    private UserRegisterDTO user = new UserRegisterDTO();

    private async Task Register()
    {
        var result = await userServices.RegisterUser(user);
        if (result)
        {
            //await localStorage.SetItemAsync("savedUser", user);
            NavigationManager.NavigateTo("/LogIn", true);
        }
    }

    void HandleSubmitValidForm()
    {
        //user = new UserRegisterDTO();
        Console.WriteLine("Validate Succesfull");
    }
}
